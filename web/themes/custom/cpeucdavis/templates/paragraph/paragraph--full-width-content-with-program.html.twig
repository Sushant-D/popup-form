{#
/**
 * @file
 * Default theme implementation to display a paragraph.
 */
#}
{%
  set classes = [
    'paragraph',
    'paragraph--type--' ~ paragraph.bundle|clean_class,
    view_mode ? 'paragraph--view-mode--' ~ view_mode|clean_class,
    not paragraph.isPublished() ? 'paragraph--unpublished'
  ]
%}

{% block paragraph %}
    {% block content %}

        {% set image_style = content.field_image.0['#image_style'] ?? null %}
        {% set media = paragraph.field_image.entity %}
        {% set image_url = media.field_media_image.entity.fileuri %}
        {# Apply image style if one exists, otherwise use direct file URL #}
        {% if image_style %}
            {% set image_url = image_url|image_style(image_style) %}
        {% else %}
            {% set image_url = file_url(image_url) %}
        {% endif %}
        {# Get image file object for additional properties (alt text, etc.) #}
        {% set image_file = media.field_media_image.0 ?? null %}


        <section {{ attributes.addClass(classes).setAttribute('aria-labelledby', 'programs-heading').addClass('programs-intro-section') }}>


          {% if paragraph.field_program_intro_section %}
        
            {{content.field_program_intro_section}}
          {% endif %}
          {% if paragraph.field_program_intro_section %}
            <div class="program-categories-section" aria-label="Program categories">
              <div class="categories-grid">
                {% for item in paragraph.field_program_grid_section %}

                  {% set image_style = item.entity.field_image.0['#image_style'] ?? null %}
                  {% set media = item.entity.field_image.entity %}
                  {% set image_url = media.field_media_image.entity.fileuri %}
                  {# Apply image style if one exists, otherwise use direct file URL #}
                  {% if image_style %}
                      {% set image_url = image_url|image_style(image_style) %}
                  {% else %}
                      {% set image_url = file_url(image_url) %}
                  {% endif %}
                  {# Get image file object for additional properties (alt text, etc.) #}
                  {% set image_file = media.field_media_image.0 ?? null %}
                  <div class="category-item">
                    <div class="category-icon">
                      <img 
                      src="{{ image_url }}" 
                      alt="{{ image_file.alt|default('') }}">
                    </div>
                    <h3 class="category-title">
                      {{ item.entity.field_banner_title.value|render|replace({'<p>': '', '</p>': ''})|raw }}
                    </h3>
                  </div>
                {% endfor %}
              </div>
            </div>
          {% endif %}
          
        </section>

    {% endblock %}
{% endblock paragraph %}
